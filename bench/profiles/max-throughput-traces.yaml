# Profile for maximizing trace ingest throughput
resources:
  limits:
    cpu: "2"            # 2 full cores
  requests:
    cpu: "1"
    memory: "1Gi" # Ensure enough memory for high throughput
collector:
  configOverride:
    processors:
      resource/add-profile:
        attributes:
          - action: upsert
            key: benchmark.profile
            value: max-throughput-traces
      reservoir_sampler:
        size_k: 20000       # Larger reservoir for throughput
        window_duration: 15s # Shorter window, more frequent processing/exporting
        trace_aware: false   # Potentially simpler/faster sampling for raw throughput
        checkpoint_interval: 60s # Less frequent checkpointing for performance
      batch:
        send_batch_size: 2048 # Larger batch size
        timeout: 1s           # Short timeout for quick sending
    service:
      pipelines:
        traces:
          # Ensure the resource processor is included in the right order
          processors: [memory_limiter, batch, reservoir_sampler, resource/add-profile]